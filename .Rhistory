###    Lectura de sec
library(Biostrings)
sec_dna <- readDNAStringSet("secuencias/FASTA.fa")
###    Alineamiento
library(msa)
alin_1 <- msa(sec_dna, method = "ClustalW")
alin_2 <- msa(sec_dna, method = "Muscle")
# Convertir clase del obj
class(alin_1)
alin_1_2 <- msaConvert(alin_1, type="seqinr::alignment")
alin_2_2 <- msaConvert(alin_2, type="seqinr::alignment")
# Matriz de dist
matriz_dna1 <- dist.alignment(alin_1_2, "identity")
###    Dendograma
library(seqinr)
# Convertir clase del obj
class(alin_1)
alin_1_2 <- msaConvert(alin_1, type="seqinr::alignment")
alin_2_2 <- msaConvert(alin_2, type="seqinr::alignment")
# Matriz de dist
matriz_dna1 <- dist.alignment(alin_1_2, "identity")
matriz_dna2 <- dist.alignment(alin_2_2, "identity")
# Arbol
library(ape)
pdf("result/")
arbol_dna1 <- nj(matriz_dna1) # Algoritmo de union de los mas cercanos
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")
arbol_dna2 <- nj(matriz_dna2) # Algoritmo de union de los mas cercanos
plot(arbol_dna2, main="Arbol filogenetico de alineamiento con Muscle")
dev.off()
pdf("result/arboles")
arbol_dna1 <- nj(matriz_dna1) # Algoritmo de union de los mas cercanos
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")
arbol_dna2 <- nj(matriz_dna2) # Algoritmo de union de los mas cercanos
plot(arbol_dna2, main="Arbol filogenetico de alineamiento con Muscle")
dev.off()
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")
pdf("result/arboles")
arbol_dna1 <- nj(matriz_dna1) # Algoritmo de union de los mas cercanos
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")
dev.off()
pdf("result/arboles.pdf")
arbol_dna1 <- nj(matriz_dna1) # Algoritmo de union de los mas cercanos
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")
arbol_dna2 <- nj(matriz_dna2) # Algoritmo de union de los mas cercanos
plot(arbol_dna2, main="Arbol filogenetico de alineamiento con Muscle")
dev.off()
BiocManager::install("ggtree")
library(ggtree)
ggtree(arbol_dna1)
ggtree(arbol_dna1, layout="circular", branch.length = "none") %<+% sec_dna
ggtree(arbol_dna1, layout="circular", branch.length = "none") %<+% matriz_dna1
ggtree(arbol_dna1, layout="circular", branch.length = "none", mrsd = TRUE)
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree()
library(ape)
library(treeio)
library(tidyverse)
library(tidyverse)
library(ggplot2)
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(arbol_dna1, layout="slanted")
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(arbol_dna1, layout="slanted")
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(arbol_dna1, layout="slanted")
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(arbol_dna1, layout="circular")
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular")
write.jtree(arbol_dna1, file = "result/arbol_ggtree.tree")
arbol_1 <- as.phylo(arbol_dna1)
class(arbol_1)
write.jtree(arbol_dna1, file = "result/arbol_ggtree.tree")
arbol_11 <- write.jtree(arbol_dna1, file = "result/arbol_ggtree.tree")
arbol_11 <- write.jtree(arbol_1, file = "result/arbol_ggtree.tree")
arbol_11 <- write.jtree(arbol_1, file = "result/arbol_ggtree.tree")
class(arbol_1)
arbol_11 <- write.jtree(arbol_1, file = "result/arbol_ggtree.tree")
arbol_11 <- write.jtree(arbol_1, file = "result/arbol_ggtree.tree")
arbol_11 <- write.jtree(arbol_1, file = "result/arbol_ggtree.tree")
plot(arbol_dna1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular")
plot(arbol_1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular")
ggplot(arbol_1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular")
ggplot(arbol_1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(arbol_1, layout="circular")
ggplot(arbol_1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular")
plot(arbol_1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular")
arbol_11 <- write.jtree(arbol_1, file = "result/arbol_ggtree.tree")
plot(arbol_1, main="Arbol filogenetico de alineamiento con ClustalW")+
geom_tree(layout="circular") + geom_tiplab()
ggtree(arbol_dna1)
ggtree(arbol_dna1) + geom_tiplab()
ggtree(arbol_dna1, layout="circular") + geom_tiplab()
ggtree(arbol_dna1, layout="circular") + geom_tiplab() +
geom_nodepoint(color="#b5e521")
ggtree(arbol_dna1, layout="circular") + geom_tiplab() + geom_label() +
geom_nodepoint(color="#b5e521")
ggtree(arbol_dna1, layout="circular") + geom_tiplab() +
geom_nodepoint(color="#b5e521")
ggtree(arbol_dna1, layout="circular") + geom_tiplab(color='firebrick') +
geom_nodepoint(color="#b5e521")
ggtree(arbol_dna1, layout="circular") + geom_tiplab(color='firebrick') +
geom_nodepoint(color="orange")
ggtree(arbol_dna1, aes(color=trait), continuous = 'colour', yscale = "trait") +
scale_color_viridis_c() + theme_minimal()
ggtree(arbol_dna1, layout="circular") + geom_tiplab(color='firebrick') +
geom_nodepoint(color="orange") + geom_rootedge()
ggtree(arbol_dna1, layout="circular") + geom_tiplab(color='firebrick') +
geom_nodepoint(color="orange") + geom_rootedge(rootedge = 3)
ggtree(arbol_dna1, layout="circular") + geom_tiplab(color='firebrick') +
geom_nodepoint(color="orange") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, layout="circular", color="#0808E5", size=1) + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30')
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30')
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30') +
geom_cladelab(sec_dna,
mapping = aes(node = node, label = name,
image = image, color = name),
geom = "phylopic", offset = 1, offset.text=0.5)
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30') +
geom_cladelab(arbol_dna1,
mapping = aes(node = node, label = name,
image = image, color = name),
geom = "phylopic", offset = 1, offset.text=0.5)
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30') +
geom_cladelab(arbol_dna1,
mapping = aes(node = node, label = name,
image = image, color = name),
geom = "phylopic", offset = 1, offset.text=0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30') +
geom_strip()
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30') +
geom_strip()
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + geom_strip()
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + geom_strip()
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + geom_strip()
View(sec_dna)
sec_dna
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_strip(sec_dna$`MH936426 |Homo sapiens|Mexico|2016/01/18`, sec_dna$`DQ869050 |Homo sapiens|Mexico|`, barsize=2, color='red',
label="associated taxa", offset.text=.1) +
geom_strip(sec_dna$`KP223131 |Homo sapiens|USA|2014/06`, sec_dna$`KJ813439 |Homo sapiens|USA|2014/04/30`, barsize=2, color='blue',
label = "another label", offset.text=.1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_strip(`MH936426 |Homo sapiens|Mexico|2016/01/18`, `DQ869050 |Homo sapiens|Mexico|`, barsize=2, color='red',
label="associated taxa", offset.text=.1) +
geom_strip(`KP223131 |Homo sapiens|USA|2014/06`, `KJ813439 |Homo sapiens|USA|2014/04/30`, barsize=2, color='blue',
label = "another label", offset.text=.1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_strip(`MH936426 |Homo sapiens|Mexico|2010/09/01`, `DQ869050 |Homo sapiens|Mexico|`, barsize=2, color='red',
label="associated taxa", offset.text=.1) +
geom_strip(`KP223131 |Homo sapiens|USA|2014/06`, `KJ813439 |Homo sapiens|USA|2014/04/30`, barsize=2, color='blue',
label = "another label", offset.text=.1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_strip(`MH936426 |Homo sapiens|Mexico|`, `DQ869050 |Homo sapiens|Mexico|`, barsize=2, color='red',
label="associated taxa", offset.text=.1) +
geom_strip(`KP223131 |Homo sapiens|USA|2014/06`, `KJ813439 |Homo sapiens|USA|2014/04/30`, barsize=2, color='blue',
label = "another label", offset.text=.1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_strip(`JQ065907 |Homo sapiens|Mexico|2010/09/01`, `DQ869050 |Homo sapiens|Mexico|`, barsize=2, color='red',
label="associated taxa", offset.text=.1) +
geom_strip(`KP223131 |Homo sapiens|USA|2014/06`, `KJ813439 |Homo sapiens|USA|2014/04/30`, barsize=2, color='blue',
label = "another label", offset.text=.1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_strip(`JQ065907|Homo sapiens|Mexico|2010/09/01`, `DQ869050 |Homo sapiens|Mexico|`, barsize=2, color='red',
label="associated taxa", offset.text=.1) +
geom_strip(`KP223131 |Homo sapiens|USA|2014/06`, `KJ813439 |Homo sapiens|USA|2014/04/30`, barsize=2, color='blue',
label = "another label", offset.text=.1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_hilight(mapping=aes(subset = node %in% c(10, 12),
fill = S),
type = "gradient", gradient.direction = 'rt',
alpha = .8) +
scale_fill_manual(values=c("steelblue", "darkgreen"))
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_hilight(mapping=aes(subset = node %in% c(10, 12),
fill = S),
type = "gradient", gradient.direction = 'rt',
alpha = .8) +
scale_fill_manual(values=c("steelblue", "darkgreen"))
arbol_dna1
summary(arbol_dna1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_hilight(mapping=aes(subset = node),
type = "gradient", gradient.direction = 'rt',
alpha = .8) +
scale_fill_manual(values=c("steelblue", "darkgreen"))
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_hilight(mapping=aes(subset = node),
type = "gradient", gradient.direction = 'rt',
alpha = .8) +
scale_fill_manual(values=c("steelblue", "darkgreen"))
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_hilight(mapping=aes(subset = node  %in% c(10, 12)),
type = "gradient", gradient.direction = 'rt',
alpha = .8) +
scale_fill_manual(values=c("steelblue", "darkgreen"))
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_hilight(mapping=aes(subset = node  %in% c(10, 12), fill = labels ),
type = "gradient", gradient.direction = 'rt',
alpha = .8) +
scale_fill_manual(values=c("steelblue", "darkgreen"))
ggtree(arbol_dna1, layout="circular", color="#0808E5", branch.length='none') + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30')
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green', aes(label=label), offset = .2) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='green', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), x=3.5, hjust=1) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), x=3.5) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), parse="emoji", size=15, vjust=.25) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), parse="emoji", size=15, vjust=.25) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_text2(geom_tiplab(parse="emoji", size=10, vjust=.25))
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_text2(parse="emoji", size=10, vjust=.25)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_text2(parse="emoji", fontsize = 12)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
scale_color_brewer(palette='Set1', breaks=1:4)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
scale_color_brewer(palette='Set1', breaks=1:4)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_tiplab(angle=90, hjust=1, offset=-10, show.legend=FALSE)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_tiplab(angle=90, hjust=1, offset=-10, show.legend=FALSE)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_tippoint(aes(size=population), alpha=.6)
tree_text <- paste0("(((((cow, (whale, dolphin)), (pig2, boar)),",
"camel), fish), seedling);")
tree_text
x <- read.tree(text=tree_text)
library(ggimage)
p <-  ggtree(x, size=2) + geom_tiplab(size=20, parse='emoji') +
xlim(NA, 7) + ylim(NA, 8.5)
svglite::svglite("emoji.svg", width = 10, height = 7)
library(ggimage)
install.packages("ggimage")
library(ggimage)
library(ggplot2)
library(ggtree)
tt = '((snail,mushroom),(((sunflower,evergreen_tree),leaves),green_salad));'
tree = read.tree(text = tt)
d <- data.frame(label = c('snail','mushroom', 'sunflower',
'evergreen_tree','leaves', 'green_salad'),
group = c('animal', 'fungi', 'flowering plant',
'conifers', 'ferns', 'mosses'))
p <- ggtree(tree, linetype = "dashed", size=1, color='firebrick') %<+% d +
xlim(0, 4.5) + ylim(0.5, 6.5) +
geom_tiplab(parse="emoji", size=15, vjust=.25) +
geom_tiplab(aes(label = group), geom="label", x=3.5, hjust=1)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label)) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) +
geom_tippoint(aes(size=population), alpha=.6)
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5) + theme_tree('grey30')
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
pdf("result/arbol1_con_ggtree")
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
dev.off()
pdf("result/arbol1_con_ggtree.pdf")
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
dev.off()
# BiocManager::install("ggtree")
library(ggtree)
library(ggplot2)
library(treeio)
library(ggtree)
pdf("result/arbol1_con_ggtree.pdf")
ggtree(arbol_dna1, layout="circular", color="#0808E5") + geom_tiplab(color='green') +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
ggtree(arbol_dna1, color="#0808E5") + geom_tiplab(color='grey30', aes(label=label), offset = .01) +
geom_nodepoint(color="red") + geom_rootedge(rootedge = 0.5)
dev.off()
