ggtree(tree, layout = "circular", branch.length = 'none') %<+% sample_data + # %<+% agrega un dataframe con datos de muestra al árbol
  aes(color = Belgium)+                       # colorea las ramas de acuerdo con una variable en tu dataframe
  scale_color_manual(
    name = "Sample Origin",                      # nombre de tu esquema de color (aparecerá en la leyenda así) 
    breaks = c("Yes", "No"),                     # las diferentes opciones en tu variable
    labels = c("NRCSS Belgium", "Other"),        # cómo quieres que se nombren las diferentes opciones en tu leyenda, permite formatearlas
    values = c("blue", "black"),                 # el color que deseas asignar a la variable  
    na.value = "black") +                        # colorea los valores no disponibles (NA) en negro 
  new_scale_color()+                             # permite añadir un esquema de color adicional para otra variable
  geom_tippoint(
    mapping = aes(color = Continent),          # color de la punta por continente Puedes cambiar la forma añadiendo "shape = "
    size = 1.5)+                               # define el tamaño de la punta
  scale_color_brewer(
    name = "Continent",                    # nombre de tu esquema de color (se mostrará en la leyenda así)
    palette = "Set1",                      # elegimos un conjunto de colores que vienen con el paquete de Brewer
    na.value = "grey") +                    # para los valores NA elegimos el color gris
  geom_tiplab(                             # añade el nombre de la muestra en la punta de su rama 
    color = 'black',                       # añade tantas líneas de texto como desees con + , pero es posible que tengas que ajustar el valor de desplazamiento para colocarlas una al lado de la otra
    offset = 1,
    size = 1,
    geom = "text",
    #align = TRUE
  )+    
  ggtitle("Phylogenetic tree of Shigella sonnei")+       # Nombre del árbol
  theme(
    axis.title.x = element_blank(), # elimina el título del eje x
    axis.title.y = element_blank(), # elimina el título del eje y
    legend.title = element_text(    # define el tamaño y el formato de la fuente del título de la leyenda
      face = "bold",
      size = 12),   
    legend.text=element_text(       # define el tamaño de letra y tipografía de la leyenda
      face = "bold",
      size = 10),  
    plot.title = element_text(      # define el tamaño de letra y tipografía del título del gráfico
      size = 12,
      face = "bold"),  
    legend.position = "bottom",     # define la posición de la leyenda
    legend.box = "vertical",        # define la posición de la leyenda
    legend.margin = margin())   